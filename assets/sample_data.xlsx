import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import os

def create_light_sample_data():
    """Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù…Ø®ÙÙØ© Ù„Ù„Ø£ØµÙˆÙ„"""
    
    # Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ÙÙØ© - 20 Ø³Ø¬Ù„ ÙÙ‚Ø·
    data = {
        'Entity': ['Ø§Ù„Ù‡ÙŠØ¦Ø©'] * 20,
        'Entity Code': ['0047'] * 20,
        'Level 1 FA Module Code': ['13', '13', '13', '13', '13', '13', '13', '13', '15', '15', '15', '15', '08', '08', '13', '13', '13', '15', '15', '08'],
        'Level 1 FA Module - English Description': [
            'Information Technology Assets', 'Information Technology Assets', 'Information Technology Assets', 
            'Information Technology Assets', 'Information Technology Assets', 'Information Technology Assets',
            'Information Technology Assets', 'Information Technology Assets', 'Office Furniture', 'Office Furniture',
            'Office Furniture', 'Office Furniture', 'Vehicles and Transportation', 'Vehicles and Transportation',
            'Information Technology Assets', 'Information Technology Assets', 'Information Technology Assets',
            'Office Furniture', 'Office Furniture', 'Vehicles and Transportation'
        ],
        'Level 2 FA Module Code': ['02', '02', '02', '02', '02', '02', '02', '02', '01', '01', '01', '01', '01', '01', '02', '02', '02', '01', '01', '01'],
        'Level 2 FA Module - English Description': [
            'Office IT and Communication Equipment', 'Office IT and Communication Equipment', 
            'Office IT and Communication Equipment', 'Office IT and Communication Equipment',
            'Office IT and Communication Equipment', 'Office IT and Communication Equipment',
            'Office IT and Communication Equipment', 'Office IT and Communication Equipment',
            'Desks and Chairs', 'Desks and Chairs', 'Desks and Chairs', 'Desks and Chairs',
            'Cars and Vehicles', 'Cars and Vehicles', 'Office IT and Communication Equipment',
            'Office IT and Communication Equipment', 'Office IT and Communication Equipment',
            'Desks and Chairs', 'Desks and Chairs', 'Cars and Vehicles'
        ],
        'Level 3 FA Module Code': ['03', '03', '04', '04', '05', '05', '03', '04', '01', '01', '02', '02', '01', '01', '03', '04', '05', '01', '02', '01'],
        'Level 3 FA Module - English Description': [
            'Display Screens & Monitors', 'Display Screens & Monitors', 'Laptops & Computers', 
            'Laptops & Computers', 'Personal Communication Devices', 'Personal Communication Devices',
            'Display Screens & Monitors', 'Laptops & Computers', 'Office Chairs', 'Office Chairs',
            'Office Desks', 'Office Desks', 'Sedan Cars', 'Sedan Cars', 'Display Screens & Monitors',
            'Laptops & Computers', 'Personal Communication Devices', 'Office Chairs', 'Office Desks',
            'Sedan Cars'
        ],
        'Asset Description For Maintenance Purpose': [
            'Ø´Ø§Ø´Ø© Ø­Ø§Ø³Ø¨ Ø§Ù„ÙŠ HP E273', 'Ø´Ø§Ø´Ø© Ø­Ø§Ø³Ø¨ Ø§Ù„ÙŠ DELL U2419', 'Ø¬Ù‡Ø§Ø² Ø­Ø§Ø³Ø¨ Ù…Ø­Ù…ÙˆÙ„ HP EliteBook',
            'Ø¬Ù‡Ø§Ø² Ø­Ø§Ø³Ø¨ Ù…Ø­Ù…ÙˆÙ„ DELL Latitude', 'Ù‡Ø§ØªÙ CISCO CP-8845', 'Ù‡Ø§ØªÙ IP Phone',
            'Ø´Ø§Ø´Ø© Ø­Ø§Ø³Ø¨ Ø§Ù„ÙŠ Samsung S24', 'Ø¬Ù‡Ø§Ø² Ø­Ø§Ø³Ø¨ Ù…ÙƒØªØ¨ÙŠ', 'ÙƒØ±Ø³ÙŠ Ù…ÙƒØªØ¨ Ù…Ø±ÙŠØ­', 'ÙƒØ±Ø³ÙŠ Ù…Ø¯ÙŠØ±',
            'Ù…ÙƒØªØ¨ Ù…ÙˆØ¸Ù', 'Ù…ÙƒØªØ¨ Ù…Ø¯ÙŠØ±', 'ØªÙˆÙŠÙˆØªØ§ ÙƒØ§Ù…Ø±ÙŠ 2022', 'Ù‡ÙŠÙˆÙ†Ø¯Ø§ÙŠ Ø§Ù„Ù†ØªØ±Ø§ 2023',
            'Ø´Ø§Ø´Ø© Ø­Ø§Ø³Ø¨ Ø§Ù„ÙŠ LG Ultra', 'Ø¬Ù‡Ø§Ø² Ø­Ø§Ø³Ø¨ Ù…Ø­Ù…ÙˆÙ„ Lenovo', 'Ù‡Ø§ØªÙ Yealink',
            'ÙƒØ±Ø³ÙŠ Ø²Ø§Ø¦Ø±', 'Ù…ÙƒØªØ¨ Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª', 'ØªÙˆÙŠÙˆØªØ§ Ù„Ø§Ù†Ø¯ÙƒØ±ÙˆØ²Ø±'
        ],
        'Manufacturer': ['HP', 'DELL', 'HP', 'DELL', 'CISCO', 'Yealink', 'Samsung', 'HP', 'IKEA', 'IKEA', 
                        'IKEA', 'IKEA', 'Toyota', 'Hyundai', 'LG', 'Lenovo', 'Yealink', 'IKEA', 'IKEA', 'Toyota'],
        'Date Placed in Service': [
            '2022-01-15', '2022-03-20', '2022-02-10', '2022-05-15', '2022-04-01',
            '2022-06-20', '2022-07-10', '2022-08-05', '2021-11-10', '2021-12-15',
            '2021-11-20', '2021-12-20', '2022-06-01', '2023-01-10', '2022-09-15',
            '2022-10-20', '2022-11-05', '2022-01-10', '2022-02-15', '2023-02-01'
        ],
        'Cost': [1500, 1800, 3000, 3500, 800, 700, 1600, 2500, 600, 1200, 800, 1500, 90000, 75000, 1700, 3200, 750, 500, 1200, 120000],
        'Depreciation amount': [500, 600, 1000, 1167, 267, 233, 533, 833, 120, 240, 160, 300, 18000, 15000, 567, 1067, 250, 100, 240, 24000],
        'Net Book Value': [1000, 1200, 2000, 2333, 533, 467, 1067, 1667, 480, 960, 640, 1200, 72000, 60000, 1133, 2133, 500, 400, 960, 96000],
        'Useful Life': [3, 3, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 3, 3, 3, 5, 5, 5],
        'Country': ['Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©'] * 20,
        'Region': ['Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©', 
                  'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©',
                  'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©'],
        'City': ['Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø¬Ø¯Ø©', 'Ø¬Ø¯Ø©', 'Ø§Ù„Ø¯Ù…Ø§Ù…', 'Ø§Ù„Ø®Ø¨Ø±', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 
                'Ù…ÙƒØ©', 'Ù…ÙƒØ©', 'Ø§Ù„Ø¸Ù‡Ø±Ø§Ù†', 'Ø§Ù„Ø¯Ù…Ø§Ù…', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø¬Ø¯Ø©', 'Ø¬Ø¯Ø©', 'Ø§Ù„Ø®Ø¨Ø±', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø¬Ø¯Ø©'],
        'Custodian': [
            'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
            'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
            'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
            'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©',
            'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª', 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©'
        ]
    }
    
    # Ø¥Ø¶Ø§ÙØ© Ø£Ø¹Ù…Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ø¨Ù‚ÙŠÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    additional_columns = {
        'accounting group Code': ['01'] * 20,
        'accounting group Arabic Description': ['Ø§Ù„Ø§Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø¯Ø§Øª ÙˆØ§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª'] * 20,
        'accounting group English Description': ['PPE'] * 20,
        'Asset Code For Accounting Purpose': [f"1302030{i}" for i in range(1, 21)],
        'Asset Functional Code': ['Not Available'] * 20,
        'GL account': ['Not Available'] * 20,
        'Cost Center': ['Not Available'] * 20,
        'Asset Owner': ['Ø§Ù„Ù‡ÙŠØ¦Ø©'] * 20,
        'Consolidated Code': ['Not Available'] * 20,
        'Unique Asset Number in MoF system': ['Not Available'] * 20,
        'Linked/Associated Asset': ['Not Available'] * 20,
        'Unique Asset Number in the entity': [f"ASSET{i:04d}" for i in range(1, 21)],
        'Asset Description': data['Asset Description For Maintenance Purpose'],
        'Tag number': [f"24{i:05d}" for i in range(10001, 10021)],
        'Base Unit of Measure': ['Ø§Ù„Ø¹Ø¯Ø¯'] * 20,
        'Quantity': [1] * 20,
        'Accumulated Depreciation': [data['Cost'][i] - data['Net Book Value'][i] for i in range(20)],
        'Residual Value': [0] * 20,
        'Remaining useful life': [data['Useful Life'][i] - 1 for i in range(20)],
        'Geographical Coordinates': ['Not Available'] * 20,
        'National Address ID': ['Not Available'] * 20,
        'Building Number': ['B001', 'B001', 'B002', 'B002', 'B003', 'B003', 'B001', 'B001', 'B002', 'B002', 
                           'B003', 'B003', 'B004', 'B004', 'B001', 'B002', 'B003', 'B001', 'B002', 'B004'],
        'Floors Number': ['F01', 'F01', 'G00', 'G00', 'F02', 'F02', 'F01', 'F01', 'G00', 'G00', 
                         'F02', 'F02', 'G00', 'G00', 'F01', 'G00', 'F02', 'F01', 'G00', 'G00'],
        'Room/office Number': [f"{i:03d}" for i in range(101, 121)]
    }
    
    # Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    data.update(additional_columns)
    
    # Ø¥Ù†Ø´Ø§Ø¡ DataFrame
    df = pd.DataFrame(data)
    
    # Ø­ÙØ¸ ÙÙŠ Ù…Ù„Ù Excel
    output_path = 'assets/sample_data.xlsx'
    os.makedirs('assets', exist_ok=True)
    
    with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
        df.to_excel(writer, sheet_name='FAR as of 30 Dec 23', index=False)
        
        # Ø¥Ø¶Ø§ÙØ© sheet Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
        stats_data = {
            'Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©': ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„', 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒÙ„ÙØ©', 'Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙƒÙ„ÙØ©', 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù‡Ù„Ø§Ùƒ', 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙØªØ±ÙŠØ©'],
            'Ø§Ù„Ù‚ÙŠÙ…Ø©': [
                len(df),
                df['Cost'].sum(),
                df['Cost'].mean(),
                df['Accumulated Depreciation'].sum(),
                df['Net Book Value'].sum()
            ],
            'Ø§Ù„ÙˆØ­Ø¯Ø©': ['Ø£ØµÙ„', 'Ø±ÙŠØ§Ù„', 'Ø±ÙŠØ§Ù„', 'Ø±ÙŠØ§Ù„', 'Ø±ÙŠØ§Ù„']
        }
        stats_df = pd.DataFrame(stats_data)
        stats_df.to_excel(writer, sheet_name='Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª', index=False)
    
    print(f"âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„Ù…Ø®ÙÙ: {output_path}")
    print(f"ğŸ“Š ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ {len(df)} Ø³Ø¬Ù„ Ù„Ø£ØµÙˆÙ„ Ù…ØªÙ†ÙˆØ¹Ø©")
    print(f"ğŸ’¾ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù: {os.path.getsize(output_path) / 1024:.1f} ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª")
    
    return df

if __name__ == "__main__":
    create_light_sample_data()
